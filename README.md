# Курсовой проект по предмету Информационные системы и базы данных

### Предметная область "Вселенная анимационного сериала Наруто"

Существует мир ниндзя. В нём живут ниндзя и обычные люди. Мир разделён на страны, охраняемые деревнями (скрытыми селениями). Каждая страна охраняется одной и только одной деревней. Ниндзя живут в деревнях. Один ниндзя может жить только в одной деревне. Ниндзя принадлежит клану. Ниндзя может принадлежать только одному клану. Если родители из разных кланов выбирается более престижный. Бидзю это древние животные ниндзя. Деревня может захватить бидзю и запечатать его в одном из ниндзя, этот ниндзя становится Джинчурики. Бидзю различаются количеством хвостов, от одного до десяти, чем больше хвостов, тем он сильнее. Семьи ниндзя, проживающие в скрытых деревнях, отдают своих детей в академию ниндзя в малом возрасте и детям назначается ранг ученик академии. Каждый ниндзя в период службы зарабатывает ранги: ученик академии/генин/чунин/джонин/анбу/каге. Получение второго и третего рангов сопровождается экзаменом, по его итогам решается, перешел ли ниндзя на следующую ступень. Ниндзя используют техники. Техники могут быть запретными, могут быть особенностью клана, могут быть стихийными. Техники особенностей клана используют только наследники клана. Ниндзя участвуют в сражениях и войнах. Сражения происходят на территориях разных стран, рождают героев и получают жертвы. Если во время войны был убит глава деревни (Каге), по итогам войны выбирается новый из числа героев. В войнах также есть противоборствующие стороны, но также войны являются совокупностью битв.

### Модель базы данных 
![модель базы данных](https://github.com/Avvessalom/ITMO-Information-Systems-and-Databases-Course-Project/blob/main/img/KP.jpg)
### Описание основных прецедентов
Прецедент             | А 
:-----                | :----: 
ID                    | 3 
Краткое описание      | а
Главные акторы        | a
Второстепенные акторы | нет
Предусловия           | ф
Основной поток        | а

Прецедент             | А 
:-----                | :----: 
ID                    | 3 
Краткое описание      | а
Главные акторы        | a
Второстепенные акторы | нет
Предусловия           | ф
Основной поток        | а

Прецедент             | А 
:-----                | :----: 
ID                    | 3 
Краткое описание      | а
Главные акторы        | a
Второстепенные акторы | нет
Предусловия           | ф
Основной поток        | а

Прецедент             | А 
:-----                | :----: 
ID                    | 3 
Краткое описание      | а
Главные акторы        | a
Второстепенные акторы | нет
Предусловия           | ф
Основной поток        | а  
### Функции:
* `clan_selection_for_a_child` - функция позволяет определять принадлежность новорожденного ниндзя к клану;
* `seal_the_biju` - функция позволяет осуществлять смену Джинчурики;
* `choose_kage_candidates` - функция позволяет показать кандидатов на должность нового Каге в случае смерти предыдущего;
* `check_clan` - простая вспомогательная функция, возвращающая присутствует проверяемый ниндзя в проверяемом клане или нет
### Триггеры:
* `on_destroy` - триггер срабатывающий при взаимодействии с `destroyed_village` и добавляющий руины на место уничтоженной деревни;  
* `on_jinchuriki_die` - триггер запрещающий удаление Джинчурики;
* `on_actions_with_village` - триггер срабатывающий при удалении деревни из `hidden_village` и  автоматически вносящий изменения в `destroyed_village`; 
* `on_death` - триггер срабатывающий при смерти ниндзя и проверяющий был ли он Каге. В случае если это так начинается подбор кандидатов на его место.
* `check_blood_restriction` - триггер срабатывающий каждый раз, когда к ниндзя добавляется новая техника. Триггер проверяет, является ли техника особенностью клана. И если является, то может ли этот ниндзя её использовать. 
* `check_clan_leader` - триггер срабатывающий при обновлении лидеров клана. Проверяет, присутствует ли претендент в клане и жив ли он
* `check_parents` - триггер срабатывающий при добавлении пары `Родитель_Ребенок` и проверяющий не является ли родитель этого ребенка дважды его родителем. Также проверяется количество родителей, не больше двух.
### Индексы:
* `ninjaid` - hash индекс на атрибут `ninja_id` таблицы `Ninja`, необходим в следствии частого 
* `countryid` - 
* `clan_name` - составной b-tree индекс на атрибуты `clan_id` и `name` таблицы `Clan` необходим для 